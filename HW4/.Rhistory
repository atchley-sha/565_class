source("~/565_class/HW4/HW4.R", echo=TRUE)
#### Question 2 ####
lmvot <- mlogit(CHOSEN ~ TVTT + COST, worktrips)
summary(lmvot)
lmvot$coefficients
lmvot$coefficients
lmvot$coefficients$TVTT
lmvot$coefficients["TVTT"]
vot <- 60*lmvot$coefficients["TVTT"] / 100*lmvot$coefficients["COST"]
vot
vot <- 60*lmvot$coefficients["TVTT"] / 100*lmvot$coefficients["COST"]
vot
lmvot$coefficients["TVTT"]
lmvot$coefficients["TVTT"]*60
vot <- lmvot$coefficients["TVTT"]*60 / lmvot$coefficients["COST"]
vot
vot <- lmvot$coefficients["TVTT"] / lmvot$coefficients["COST"] * (60/100)
vot
vot <- lmvot$coefficients["TVTT"] / lmvot$coefficients["COST"] * (60/100) %>%
unname()
vot
vot <- lmvot$coefficients["TVTT"] / lmvot$coefficients["COST"] * (60/100) %>%
unlist()
vot
vot <- lmvot$coefficients["TVTT"] / lmvot$coefficients["COST"] * (60/100)
vot
typeof(vot)
vot
names(vot)
unname(vot)
vot <- unname(lmvot$coefficients["TVTT"] / lmvot$coefficients["COST"] * (60/100))
vot
vot <- unname(lmvot$coefficients["TVTT"]) / unname(lmvot$coefficients["COST"]) * (60/100)
vot
#### Question 3 ####
lmwait <- mlogit(CHOSEN ~ IVTT + OVTT, worktrips)
summary(lmwait)
wait <- unname(lmvot$coefficients["OVTT"]) / unname(lmvot$coefficients["IVTT"])
wait
wait <- unname(lmwait$coefficients["OVTT"]) / unname(lmwait$coefficients["IVTT"])
wait
worktrips
#### Question 4 ####
lmdens <- mlogit(CHOSEN ~ COSTINC | RSPOPDEN + WKEMPDEN)
#### Question 4 ####
lmdens <- mlogit(CHOSEN ~ COSTINC | RSPOPDEN + WKEMPDEN, worktrips)
lmdens %>% summary()
source("X:/565_class/HW4/HW4.R", echo=TRUE)
source("X:/565_class/HW4/HW4.R", echo=TRUE)
View(lmdens)
lmtt
lmtt$coefficients
lmtt$coefficients <- c(1,2,3,4,5,6)
lmtt$coefficients
lmtt
lmtt <- mlogit(CHOSEN ~ TVTT, worktrips)
summary(lmtt)
worktrips
worktrips
summary(lmtt)
worktrips
worktrips$idx$alternative
worktrips$idx$alternative $>$ unique()
worktrips$idx$alternative %>% unique()
worktrips$idx$alternative %>% unique() %>% length()
alternatives <- worktrips$idx$alternative %>%
unique()
alternatives
##### Question 1 #####
lmeq <- tibble(c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
rep.int(1/num_alt, times = num_alt))
num_alt <- length(alternatives)
##### Question 1 #####
lmeq <- tibble(c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
rep.int(1/num_alt, times = num_alt))
lmeq
##### Question 1 #####
lmeq <- tibble(Alternative = c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
Intercept = rep.int(1/num_alt, times = num_alt),)
##### Question 1 #####
lmeq <- tibble(Alternative = c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
Intercept = rep.int(1/num_alt, times = num_alt))
lmeq
source("~/565_class/HW4/HW4.R", echo=TRUE)
bookdown:::mathquill()
remotes::install_github("ThinkR-open/remedy")
ln()
log()
2*log(.5)
worktrips$idx$id
worktrips$idx$id %>% unique()
population <- worktrips$idx$id %>%
unique()
num_alt <- length(alternatives)
num_pop <- length(population)
source("~/565_class/HW4/HW4.R", echo=TRUE)
lmeqLL <- num_pop * log(1/num_alt)
lmint <- mlogit(CHOSEN ~ 1, worktrips)
lmeqLL
lmint$logLik
source("~/565_class/HW4/HW4.R", echo=TRUE)
1-1257.1/1638
pacman::p_load(
pacman,
tidyverse,
flextable,
knitr,
mlogit,
broom,
modelsummary
)
source("X:/565_class/HW4/HW4.R", echo=TRUE)
lmttr2n <- 1- (lmtt$logLik / lmeqLL)
lmttr2n
lmtt$logLik
lmtt$est.stat
lmtt$rpar
sumary(lmtt)
summary(lmtt)
lmtt$indpar
lmtt$coefficients
lmttr2n
lmttr2n <- unname(1 - (lmtt$logLik / lmeqLL))
lmttr2n
lmttr2n %>% length()
lmttr2n <- unlist(1 - (lmtt$logLik / lmeqLL))
lmttr2n
lmttr2n[1]
lmttr2n <- (1 - (lmtt$logLik / lmeqLL))[1]
lmttr2n
lmttr2m <- (1 - (lmtt$logLik / lmint$logLik))[1]
lmttr2m
pacman::p_load(
pacman,
tidyverse,
flextable,
knitr,
mlogit,
broom,
modelsummary
)
modelsummary(list(Null = lmeq, Market = lmint, Travel = lmtt))
list(Null = lmeq, Market = lmint, Travel = lmtt)
list(Market = lmint, Travel = lmtt)
modelsummary(list(Market = lmint, Travel = lmtt))
modelsummary(list(Market = lmint, Travel = lmtt))
modelsummary_wide(list(Market = lmint, Travel = lmtt))
tidy(lmint)
lmtttidy <- tidy(lmtt)
lminttidy <- tidy(lmint)
lminttidy
lmeq
lmmttidy
lmtttidy
unite()
?unite()
lmtttidy$statistic %<>% gsub("(\d+)", "\\(\1\\)")
lmtttidy$statistic %<>% gsub("(\\d+)", "\\(\1\\)")
pacman::p_load(
pacman,
tidyverse,
flextable,
knitr,
mlogit,
broom,
modelsummary,
magrittr
)
lmtttidy$statistic %<>% gsub("(\\d+)", "\\(\1\\)")
lmtttidy
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% gsub("(\\d+)", "\\(\\1\\)")
lmtttidy <- tidy(lmtt)
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% gsub("(\\d+)", "\\(\\1\\)")
lmtttidy
lmtttidy$statistic %<>% paste0("(", . , ")")
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% paste0("(", . , ")")
lmtttidy
lmtttidy$statistic %<>% round(digits = 3) %>%
paste0("(", . , ")")
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% round(digits = 3) %>%
paste0("(", . , ")")
lmtttidy
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% round(digits = 2) %>%
paste0("(", . , ")")
lmtttidy
##### Question 1 #####
lmeq <- tibble(
Alternative = c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
Intercept = rep.int(1/num_alt, times = num_alt),
Statistic = rep.int("NA", times = num_alt))
##### Question 1 #####
lmeq <- tibble(
Alternative = c("Drive Alone", "Share 2", "Share 3+", "Transit", "Bike", "Walk"),
Intercept = rep.int(1/num_alt, times = num_alt),
Statistic = rep.int("(NA)", times = num_alt))
lmeq
lmtttidy %<>% unite("Estimate", sep = " ")
lmtttidy
lmtttidy <- tidy(lmtt) %>% round(digits = 2)
lmtttidy
lmtttidy %<>% unite("Estimate", c("estimate", "statistic") sep = " ")
lmtttidy %<>% unite("Estimate", c("estimate", "statistic"), sep = " ")
lmtttidy <- tidy(lmtt)
lmtttidy$statistic %<>% round(digits = 2) %>%
paste0("(", . , ")")
lmtttidy %<>% unite("Estimate", c("estimate", "statistic"), sep = " ")
lmtttidy
modelsummary(list(Market = lmint, Travel = lmtt))
modelsummary(list(Market = lmint, Travel = lmtt))$TVTT
modelsummary(list(Market = lmint, Travel = lmtt)) %>% typeof()
modelsummary(list(Market = lmint, Travel = lmtt))
?modelsummary
modelsummary(list(Market = lmint, Travel = lmtt), output = "flextable", estimate = "{estimate} ({std.error}){stars}")
modelsummary(list(Market = lmint, Travel = lmtt), output = "flextable", estimate = "{estimate} ({std.error}){stars}", statistic = NULL)
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL.
)
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
)
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
)
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
align = "d"
)
modelsummary(
list(Market = lmint, Travel = lmtt),
# output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
)
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = ~>1, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = ~ > 1, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = > 1, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = 2:ncol(.), align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
ncol()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
numcols()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
NumCols()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
ncol()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
?modelsummary
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = c("AIC", "BIC")
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = list("AIC", "BIC")
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = "?IC"
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
as_tibble()
modelsummary(
list(Market = lmint, Travel = lmtt),
# output = "default",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
as_tibble()
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
tidy()
datasummary_df(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
)
msummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
)
?msummary
modelsummary(
list(Market = lmint, Travel = lmtt),
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
autofit() %>%
align(j = 2:3, align = "center", part = "all")
remotes::install_github("ThinkR-open/remedy")
remotes::install_github("ThinkR-open/remedy")
remotes::install_github("ThinkR-open/remedy", force = T)
remotes::install_github("ThinkR-open/remedy", force = T)
remotes::install_github("ThinkR-open/remedy")
vot <- unname(lmvot$coefficients["TVTT"]) /
unname(lmvot$coefficients["COST"]) *
(60/100)
vot
wait
my_msummary <- function(models){
modelsummary(
models,
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
autofit()
}
my_flextable <- function(tibble){
flextable(tibble) %>%
autofit() %>%
align(align = "center", part = "all")
}
my_msummary <- function(models){
modelsummary(
models,
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
autofit()
}
lmint <- mlogit(CHOSEN ~ 1, worktrips)
lmtt <- mlogit(CHOSEN ~ TVTT, worktrips)
list(Market = lmint, Travel = lmtt) %>%
my_msummary() %>%
align(j = 2:3, align = "center", part = "all")
lmvot <- mlogit(CHOSEN ~ TVTT + COST, worktrips) %>%
my_msummary()
lmvot
lmvot <- mlogit(CHOSEN ~ TVTT + COST, worktrips) %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
lmvot <- mlogit(CHOSEN ~ TVTT + COST, worktrips) %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
lmvot
lmwait <- mlogit(CHOSEN ~ IVTT + OVTT, worktrips) %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
lmwait
wait <- unname(lmwait$coefficients["OVTT"]) /
unname(lmwait$coefficients["IVTT"])
wait
wait <- unname(lmwait$coefficients["OVTT"]) / unname(lmwait$coefficients["IVTT"])
wait
wait <- unname(lmwait$coefficients["OVTT"]) / unname(lmwait$coefficients["IVTT"])
wait
vot <- unname(lmvot$coefficients["TVTT"]) /
unname(lmvot$coefficients["COST"]) *
(60/100)
vot
lmvot <- mlogit(CHOSEN ~ TVTT + COST, worktrips)
lmvot %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
vot <- unname(lmvot$coefficients["TVTT"]) /
unname(lmvot$coefficients["COST"]) *
(60/100)
vot
lmwait <- mlogit(CHOSEN ~ IVTT + OVTT, worktrips)
lmwait %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
wait <- unname(lmwait$coefficients["OVTT"]) /
unname(lmwait$coefficients["IVTT"])
wait
lmdens <- mlogit(CHOSEN ~ COSTINC | RSPOPDEN + WKEMPDEN, worktrips)
lmdens %>%
my_msummary() %>%
align(j = 2, align = "center", part = "all")
worktrips$RSPOPDEN
worktrips
