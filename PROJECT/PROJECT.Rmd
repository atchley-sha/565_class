---
title: "Population and Job Densification in Roanoke"
author: "Hayden Atchley, Steven Goodsell, Austin Nichalson, Tristan Parker"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
geometry: margin=1in
output:
  pdf_document:
    latex_engine: lualatex
    includes:
      in_header: "preamble.tex"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

```{r load_packages, include=FALSE}
if(!require(pacman)) install.packages("pacman")
pacman::p_load(
  char = as.character(read.csv("packages.csv", header = F)[,1])
  )
install_github("atchley-sha/R-packageSHA")
library(packageSHA)
```

```{r load_functions}
source("R/functions.R")
```

\RaggedRight
\graphicspath{ {./images/} }


# Introduction

Would densifying Roanokeâ€™s population and jobs in certain locations encourage multi-modal transportation and reduce problems like congestion? To seek answers to this question, our team used a trip-based model and changed the land-use inputs in the model by editing the projected 2040 social economic (SE) data. This allowed us to see how localizing population and job growth in the downtown area compares with the no-build 2040 scenario. We also wished to look at the effects of densifying "neighborhood centers" in comparison with the no-build scenario. We seek to identify if one or both of these land use policy changes would affect mode choice and traffic congestion, and to make a recommendation based on our findings.

# Proposed Scenarios

Our first scenario is the projected "no-build" 2040 scenario, as given already in CUBE. For our other scenarios, we identified TAZs that we considered "downtown", as well as those we considered "neighborhood centers". We mainly looked at the Area Type as given in the input data to determine these TAZs, but we adjusted our selections slightly to preserve continuity and cohesiveness. The population densities and selected TAZs are shown in Figure \@ref(fig:populationDensity).

```{r populationDensity, fig.cap="Population density and selected TAZs Downtown and Neighborhood Centers."}

#Set downtown zone IDs
DTZones <- c(88,89,90,91,92,
             93,102,117,118,119,
             126,127,128,129,130,
             131,132,133,134,196,
             197,198,200,201)

#Set neighborhood centers zone IDs
NCZones <- c(42,66,97,148,149,
             160,161,176,177,178,
             179,180,181)

TAZsf <- read_sf("data/TAZ/RoanokeTAZ.shp") %>% 
  select(ID, ZONE, N)

TAZdbf <- read.dbf("data/se/se_classified_2040_NO-BUILD.dbf") %>% 
  mutate(type = case_when(Z %in% DTZones ~ "Downtown",
                          Z %in% NCZones ~ "Neighborhood Center",
                          TRUE ~ "Rural") %>% 
           as.factor() %>% 
           fct_relevel(
             "Rural",
             "Neighborhood Center",
             "Downtown"
           )) %>% 
  select(Z, type)

TAZtype <- read.dbf("data/ZONAL AT2040A.DBF")

TAZ <- left_join(TAZsf, TAZtype, by = c("N" = "N")) %>% 
  left_join(TAZdbf, by = c("ZONE" = "Z"))

TAZ$ATYPE <-  factor(
  TAZ$ATYPE,
  labels = c("2 - Urban",
             "3 - Exurban",
             "4 - Suburban",
             "5 - Rural"))

TAZsplit <- TAZ %>% 
  group_by(type) %>% 
  group_split()

fillColors <- brewer.pal(4, "Oranges") %>% rev()
colorColors <- c("grey60", "blue", "black")
borderSize <- 0.7

ggplot(TAZ) +
  geom_sf(aes(fill = ATYPE, color = type)) +
  theme_void() +
  scale_fill_manual(values = fillColors) +
  scale_color_manual(values = colorColors) +
  guides(color = guide_legend(override.aes = list(size = 1))) +
  geom_sf(data = TAZsplit[[2]], fill = NA, color = colorColors[2], size = borderSize) +
  geom_sf(data = TAZsplit[[3]], fill = NA, color = colorColors[3], size = borderSize) +
  labs(
    fill = "Area Type",
    color = "Designation"
  )

```


