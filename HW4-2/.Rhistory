# Chunk 1: setup
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
# Chunk 2: load_packages
if(!require(pacman)) install.packages("pacman")
pacman::p_load(
pacman,
tidyverse,
flextable,
knitr,
magrittr,
mlogit,
broom,
modelsummary
)
# Chunk 3: functions
my_flextable <- function(tibble){
flextable(tibble) %>%
autofit() %>%
align(align = "center", part = "all")
}
# Chunk 4: load
worktrips <- read_rds("data/worktrips_dfidx.rds")
nl <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN,  data = worktrips,
)
nl <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN,  data = worktrips,
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
summary(nl)
nl1 <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN,  data = worktrips,
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
nl1$coefficients
nl1$coefficients["iv"]
nl1 <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN,  data = worktrips,
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
summary(nl1)
nl1$coefficients["iv"]
# Chunk 1: setup
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
# Chunk 2: load_packages
if(!require(pacman)) install.packages("pacman")
pacman::p_load(
pacman,
tidyverse,
flextable,
knitr,
magrittr,
mlogit,
broom,
modelsummary
)
# Chunk 3: functions
my_flextable <- function(tibble){
flextable(tibble) %>%
autofit() %>%
align(align = "center", part = "all")
}
my_msummary <- function(models){
modelsummary(
models,
output = "flextable",
estimate = "{estimate} ({std.error}){stars}",
statistic = NULL,
gof_omit = ".IC"
) %>%
autofit() %>%
vline(j = 1) %>%
align(align = "center", part = "header") %>%
align(j = 1, align = "left", part = "all")
}
# Chunk 4: load
worktrips <- read_rds("data/worktrips_dfidx.rds")
# Chunk 5: nl1
nl1 <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN,
data = worktrips,
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
my_msummary(list(nested_model = nl1))
# Chunk 6: nl1_nest_value
nl1$coefficients["iv"]
# Chunk 7: nl2
nl2A <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN + VEHBYWRK,
data = worktrips %>% filter(HHINC < 50),
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
nl2B <- mlogit(CHOSEN ~ COST + TVTT  + OVTT | WKEMPDEN + VEHBYWRK,
data = worktrips %>% filter(HHINC > 50),
nests = list(auto = c('Drive Alone', 'Share 2', 'Share 3+'),
nonauto = c('Bike', 'Walk', 'Transit')),
un.nest.el = T)
my_msummary(list(`< $50,000` = nl2A, `> $50,000` = nl2B))
nl2A$coefficients["COST"]
tibble(`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"])
tibble(`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100)
?tibble()
tibble(`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`rownames<-`("VOT")
tibble(c("", "VOT"),
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100)
tibble("VOT",
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100)
tibble("VOT",
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
colnames()[1] <- ""
tibble("VOT",
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c("","< $50,000", "> $50,000"))
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c("","< $50,000", "> $50,000"))
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c("","< $50,000", "> $50,000")) %>%
my_flextable()
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c(" ","< $50,000", "> $50,000")) %>%
my_flextable()
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c(" ","< $50,000", "> $50,000")) %>%
my_flextable() %>%
vline(j = 1)
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c(" ","< $50,000", "> $50,000")) %>%
round(2)
tibble("VOT",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c(" ","< $50,000", "> $50,000")) %>%
mutate_if(is.numeric, round, 2) %>%
my_flextable() %>%
vline(j = 1)
tibble("$ / hr",
nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
`colnames<-`(c("VOT","< $50,000", "> $50,000")) %>%
mutate_if(is.numeric, round, 2) %>%
my_flextable() %>%
vline(j = 1)
tibble(VOT = "$ / hr",
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
mutate_if(is.numeric, round, 2) %>%
my_flextable() %>%
vline(j = 1)
tibble(VOT = "$ / hr",
`< $50,000` = nl2A$coefficients["TVTT"] / nl2A$coefficients["COST"] * 60/100,
`> $50,000` = nl2B$coefficients["TVTT"] / nl2B$coefficients["COST"] * 60/100) %>%
mutate_if(is.numeric, round, 2) %>%
my_flextable() %>%
vline(j = 1)
?format
?Sys.Date()
